# Clase 141118

## Pruebas de hipótesis

### ANOVA (1 vía)

**Contexto**:

* Una variable *Y* continua que medimos en los individuos de una población.<br>
* Una variable *X* categórica con *k* categorías (e.g., tratamientos, sitios, condiciones ambientales, características, genotipos, etc.) a la que pertenecen estos individuos.<br>
* Queremos saber si las variables *X* está relacionada con la variable *Y*.

<img src="./more/ANOVA.png" height="300px" />

**Hipótesis**

H<sub>0</sub>: *µ*<sub>1</sub> = *µ*<sub>2</sub> = ... = *µ*<sub>k</sub><br>
H<sub>a</sub>: al menos una *µ* es diferente de las otras

**Estadístico de prueba**

<img src="./more/F.png" height="75px" />

donde:

<img src="./more/Sb.png" height="75px" /> y
<img src="./more/Sw.png" height="75px" />

***R***: **anova(lm(y~x))**

Recuerden que debe **x** ser una variable categórica (pueden usar **str()** para ver si *R* la indentifica como categórica y **as.factor()** para convertir una variable en variable categórica).

### ANOVA (2 vías)

**Contexto**:

* Una variable *Y* continua que medimos en los individuos de una población.<br>
* Dos variables, *X*<sub>1</sub> y *X*<sub>2</sub> categóricas con *k*<sub>1</sub> y *k*<sub>2</sub> categorías a las que pertenecen estos individuos.<br>
* Queremos saber si las variables *X*<sub>1</sub> y *X*<sub>2</sub> están relacionadas (conjunta o independientemente) sobre la variable *Y*.

**Hipótesis**

Relación independiente de *X*<sub>1</sub>: H<sub>0</sub>: *µ*<sub>1,1</sub> = *µ*<sub>2,1</sub> = ... = *µ*<sub>k<sub>1</sub>,1</sub><br> 
Relación independiente de *X*<sub>2</sub>: H<sub>0</sub>: *µ*<sub>1,2</sub> = *µ*<sub>2,2</sub> = ... = *µ*<sub>k<sub>2</sub>,2</sub><br>
Relación conjunta de *X*<sub>1</sub> y *X*<sub>2</sub>: H<sub>0</sub>: *µ*<sub>1,1</sub> = *µ*<sub>2,1</sub> = ... = *µ*<sub>k<sub>1</sub>,1</sub> = *µ*<sub>1,2</sub> = *µ*<sub>2,2</sub> = ... = *µ*<sub>k<sub>2</sub>,2</sub><br>

**ATENCIÓN**: si no se rechaza la hipótesis de relación conjunta, no se pueden rechazar las hipótesis de relación independiente.

***R***: **anova(lm(y~x1*x2))**

Recuerden que **x1** y **x2** deben ser variables categóricas

### ANOVA (n vías)

**Contexto**:

* Una variable *Y* continua que medimos en los individuos de una población.<br>
* *n* variables, *X*<sub>1</sub>, ..., *X*<sub>*n*</sub>, categóricas a las que pertenecen estos individuos.
* Queremos saber si las variables categóricas tienen relación (conjunta o independiente) con la variable *Y*.

**Hipótesis**

Efecto independiente de *X*<sub>1</sub><br> 
...<br>
Efecto independiente de *X*<sub>n</sub><br>
Efecto conjunto de *X*<sub>1</sub> y *X*<sub>2</sub><br>
...<br>
Efecto conjunto de *X*<sub>*n*-1</sub> y *X*<sub>n</sub><br>
Efecto conjunto de *X*<sub>1</sub>, *X*<sub>2</sub> y *X*<sub>3</sub><br>
...<br>
...<br>
...<br>
Efecto conjunto de *X*<sub>1</sub>, *X*<sub>2</sub>,..., y *X*<sub>*n*</sub><br>

**ATENCIÓN**: si no se rechaza una hipótesis de efecto conjunto, no se pueden rechazar las hipótesis de relación independiente de las variables involucradas en la hipótesis de relación conjunta.

***R***: **anova(lm(y~x1*x2*x3*...*xn))**

Recuerden que **x1** ... **xn** deben ser variables categóricas

### ANOVA anidado/jerárquico/de bloques de dos vías

* Una variable *Y* continua que medimos en los individuos de una población.<br>
* Dos variables, *X*<sub>1</sub> y *X*<sub>2</sub> categóricas con *k*<sub>1</sub> y *k*<sub>2</sub> categorías a las que pertenecen estos individuos.<br>
* La variable *X*<sub>2</sub> está anidada (en un nivel inferior) al de la variable *X*<sub>1</sub> (e.g. grupos dentro de materias, municipios dentro de estados, meses dentro de años, tipos celulares dentro de tipos de tejidos, especies dentro de géneros, etc.)
* Queremos saber si las variables *X*<sub>1</sub> y *X*<sub>2</sub> está relacionada con la variable *Y*.

**Hipótesis**

Relación a nivel de *X*<sub>1</sub>: H<sub>0</sub>: *µ*<sub>1,1</sub> = *µ*<sub>2,1</sub> = ... = *µ*<sub>k<sub>1</sub>,1</sub><br> 
Relación a nivel de *X*<sub>2</sub>: H<sub>0</sub>: *µ*<sub>1,2</sub> = *µ*<sub>2,2</sub> = ... = *µ*<sub>k<sub>2</sub>,2</sub><br>

**R***: **anova(lm(y~x1/x2))**

*ACTIVIDAD1*:

**IGUAL QUE LOS ANOVAs, LOS ANOVAs ANIDADOS SE PUEDEN TENER MUCHOS NIVELES DE LA FORMA anova(lm(y~x1/x2/x3/.../xn))**

## Pruebas post-hoc para diferencias de medias

**Post-hoc**: después de esto. Es decir hacemos pruebas después de haber hecho un ANOVA (de 1 vía).

También se les puede llamar pruebas *a posteriori*.

¿Por qué no usar pruebas *t* para cada par de categorías de la variable *X*<sub>2</sub>?

Recordemos:

#### 5.  H<sub>0</sub>: *µ*<sub>1</sub> = *µ*<sub>2</sub>, *sigmas* desconocidas

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;H<sub>a</sub>: *µ*<sub>1</sub> ≠ *µ*<sub>2</sub>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Estadístico de prueba: T = (x1.barra-x2.barra)/sqrt(S<sub>1</sub><sup>2</sup>/n<sub>1</sub>+S<sub>2</sub><sup>2</sup>/n<sub>2</sub>)

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Distribución del estadístico: t-Student con v g.l.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;R: **t.test()**

Imaginemos que tenemos una variable *X* con 3 categorías. Si quisiéramos usar pruebas *t* haríamos 

H<sub>0</sub>: *µ*<sub>1</sub> = *µ*<sub>2</sub><br>
H<sub>0</sub>: *µ*<sub>1</sub> = *µ*<sub>3</sub><br>
H<sub>0</sub>: *µ*<sub>2</sub> = *µ*<sub>3</sub><br>

En cada una tendríamos una probabilidad *alfa* de equivocarnos y rechazar la hipótesis nula cuando en realidad es cierta. En conjunto tendríamos *&alpha;*<sup>3</sup>









